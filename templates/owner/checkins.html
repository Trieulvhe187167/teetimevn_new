{% extends 'owner/layout.html' %}

{% block owner_content %}
<div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center mb-4">
  <div>
    <h1 class="h4 fw-semibold mb-1">{{ _('Daily check-in board') }}</h1>
    <p class="text-muted mb-0">{{ _('Schedule for %(date)s', date=today) }}</p>
  </div>
  <a href="{{ url_for('owner.booking_list', lang=lang) }}" class="btn btn-outline-success mt-3 mt-md-0">
    <i class="bi bi-list-check me-2"></i>{{ _('Manage bookings') }}
  </a>
</div>

<div class="card border-0 shadow-sm">
  <div class="table-responsive">
    <table class="table align-middle mb-0">
      <thead class="table-light">
        <tr>
          <th scope="col">#</th>
          <th scope="col">{{ _('Course') }}</th>
          <th scope="col">{{ _('Tee time') }}</th>
          <th scope="col">{{ _('Players') }}</th>
          <th scope="col">{{ _('Customer') }}</th>
          <th scope="col">{{ _('Status') }}</th>
          <th scope="col" class="text-end">{{ _('Actions') }}</th>
        </tr>
      </thead>
      <tbody>
        {% if bookings %}
          {% for booking in bookings %}
            <tr class="{% if booking['no_show'] %}table-warning{% elif booking['check_out_at'] %}table-success-subtle{% elif booking['check_in_at'] %}table-info-subtle{% endif %}">
              <td class="fw-semibold">#{{ booking['id'] }}</td>
              <td>{{ booking['course_name'] }}</td>
              <td>{{ booking['play_time'] }}</td>
              <td>{{ booking['players'] }}</td>
              <td>
                <div class="fw-semibold">{{ booking['fullname'] }}</div>
                <div class="text-muted small">{{ booking['phone'] }}</div>
              </td>
              <td>
                {% if booking['no_show'] %}
                  <span class="badge bg-warning text-dark">{{ _('No-show') }}</span>
                {% elif booking['check_out_at'] %}
                  <span class="badge bg-success-subtle text-success border border-success">{{ _('Checked-out') }}</span>
                {% elif booking['check_in_at'] %}
                  <span class="badge bg-info-subtle text-info border border-info">{{ _('Checked-in') }}</span>
                {% else %}
                  <span class="badge bg-light text-dark border">{{ booking['status']|capitalize }}</span>
                {% endif %}
              </td>
              <td class="text-end">
                <div class="btn-group btn-group-sm" role="group">
                  <form action="{{ url_for('owner.mark_check_in', lang=lang, booking_id=booking['id']) }}"
                        method="post" class="d-inline">
                    <button type="submit" class="btn btn-outline-success"
                            {% if booking['check_in_at'] or booking['no_show'] %}disabled{% endif %}>
                      {{ _('Check-in') }}
                    </button>
                  </form>
                  <form action="{{ url_for('owner.mark_check_out', lang=lang, booking_id=booking['id']) }}"
                        method="post" class="d-inline">
                    <button type="submit" class="btn btn-outline-primary"
                            {% if not booking['check_in_at'] or booking['check_out_at'] or booking['no_show'] %}disabled{% endif %}>
                      {{ _('Check-out') }}
                    </button>
                  </form>
                  <form action="{{ url_for('owner.mark_no_show', lang=lang, booking_id=booking['id']) }}"
                        method="post" class="d-inline">
                    <input type="hidden" name="reason" value="">
                    <button type="submit" class="btn btn-outline-warning"
                            {% if booking['no_show'] or booking['check_out_at'] %}disabled{% endif %}>
                      {{ _('No-show') }}
                    </button>
                  </form>
                </div>
                <a href="{{ url_for('owner.booking_detail', lang=lang, booking_id=booking['id']) }}"
                   class="btn btn-link btn-sm d-block mt-2 text-decoration-none">
                  {{ _('View details') }}
                </a>
              </td>
            </tr>
          {% endfor %}
        {% else %}
          <tr>
            <td colspan="7" class="text-center text-muted py-4">
              {{ _('No bookings scheduled for today.') }}
            </td>
          </tr>
        {% endif %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}

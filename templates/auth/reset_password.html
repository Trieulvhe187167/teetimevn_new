{% extends 'base.html' %}
{% block title %}{{ _('Reset Password') }} | TEEtimeVN{% endblock %}

{% block content %}
<div class="row justify-content-center">
  <div class="col-lg-6">
    <div class="card shadow-sm">
      <div class="card-header bg-info text-white">
        <h5 class="mb-0">{{ _('Reset Password') }}</h5>
      </div>
      <div class="card-body">
        <form method="post">
          <input type="hidden" name="token" value="{{ token }}">

          <div class="mb-3 position-relative">
            <label for="new_password" class="form-label">{{ _('New Password') }}</label>
            <input type="password"
       name="password"
       id="new_password"
       class="form-control"
       required minlength="8"
       pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&]).{8,}$"
       title="{{ _('At least 8 characters with uppercase, lowercase, number, and special character') }}"
       placeholder="{{ _('Enter new password') }}" />
            <svg xmlns="http://www.w3.org/2000/svg"
                 fill="none"
                 viewBox="0 0 24 24"
                 stroke-width="1.5"
                 stroke="currentColor"
                 class="toggle-password-svg"
                 data-target="new_password">
              <path stroke-linecap="round" stroke-linejoin="round"
                    d="M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 
                       7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 
                       7.178.07.207.07.431 0 .639C20.577 16.49 
                       16.64 19.5 12 19.5c-4.638 0-8.573-3.007-
                       9.963-7.178Z" />
              <path stroke-linecap="round" stroke-linejoin="round"
                    d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
            </svg>
          </div>

          <div class="mb-3 position-relative">
            <label for="confirm_password" class="form-label">{{ _('Confirm Password') }}</label>
            <input type="password"
       name="confirm_password"
       id="confirm_password"
       class="form-control"
       required minlength="8"
       pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&]).{8,}$"
       title="{{ _('Repeat the same password') }}"
       placeholder="{{ _('Re-enter new password') }}" />
            <svg xmlns="http://www.w3.org/2000/svg"
                 fill="none"
                 viewBox="0 0 24 24"
                 stroke-width="1.5"
                 stroke="currentColor"
                 class="toggle-password-svg"
                 data-target="confirm_password">
              <path stroke-linecap="round" stroke-linejoin="round"
                    d="M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 
                       7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 
                       7.178.07.207.07.431 0 .639C20.577 16.49 
                       16.64 19.5 12 19.5c-4.638 0-8.573-3.007-
                       9.963-7.178Z" />
              <path stroke-linecap="round" stroke-linejoin="round"
                    d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
            </svg>
          </div>

          <button type="submit" class="btn btn-info w-100">{{ _('Reset Password') }}</button>
        </form>
        <p class="mt-3 text-center">
          <a href="{{ url_for('index', lang=lang) }}">{{ _('Back to Home') }}</a>
        </p>
      </div>
    </div>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
  const pw  = document.getElementById("new_password");
  const cpw = document.getElementById("confirm_password");
  if (pw && cpw) {
    const check = () => {
      if (cpw.value !== pw.value) {
        cpw.setCustomValidity("Passwords do not match");
      } else {
        cpw.setCustomValidity("");
      }
    };
    pw.addEventListener("input", check);
    cpw.addEventListener("input", check);
  }
});
</script>

{% endblock %}
